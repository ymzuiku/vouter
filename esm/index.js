var T=Object.defineProperty;var h=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var y=(t,e,r)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,p=(t,e)=>{for(var r in e||(e={}))w.call(e,r)&&y(t,r,e[r]);if(h)for(var r of h(e))x.call(e,r)&&y(t,r,e[r]);return t};var v=(t,e)=>{var r={};for(var n in t)w.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&h)for(var n of h(t))e.indexOf(n)<0&&x.call(t,n)&&(r[n]=t[n]);return r};import*as s from"react";import{lazy as G}from"react";import{createContext as M,Suspense as J,useContext as X,useMemo as A}from"react";import{CreateObserver as N,useObserver as W}from"react-ob";var R=[],U=t=>{R.push(t)};["popstate","pushState","replaceState","backState"].forEach(t=>{window.addEventListener(t,()=>{t==="popstate"&&o.stack.pop(),R.forEach(e=>{e(t,o.stack)})})});var u=t=>({url:t,path:t.split("?")[0],time:Date.now(),index:o.stack.length}),O=t=>{o.stack.forEach(e=>{e.tempData=void 0}),o.stack.push(u(t)),o.useHash&&(t="/#"+t),history.pushState(null,"",t),window.dispatchEvent(new Event("pushState"))},b=(t,e)=>{if(o.stack.forEach(r=>{r.tempData=void 0}),o.stack.length>0&&o.stack.pop(),o.stack.push(u(t)),o.useHash&&(t="/#"+t),e){let r=o.stack[o.stack.length-1];r.tempData=e}history.replaceState(null,"",t),window.dispatchEvent(new Event("replaceState"))},H=t=>{o.stack.length>1&&o.stack.pop();let e=o.stack[o.stack.length-1];if(o.stack.length===1){let n=e.time,a=e.url;e=u(o.onLastBack(e)),a===e.url&&(e.time=n),o.stack[o.stack.length-1]=e}let r=e.url;o.useHash&&(r="/#"+e.url),t&&(o.stack[o.stack.length-1].tempData=t),history.replaceState(null,"",r),window.dispatchEvent(new Event("backState"))},F=t=>{o.stack=[u(t)],b(t)},o={push:O,replace:b,goBack:H,clearTo:F,listen:U,onLastBack:t=>t.url,newStack:u,stack:[],useHash:!1};var m=N({n:0});o.listen(()=>{m.val.n+=1,m.next()});function z(){return s.createElement("div",{style:{padding:100,margin:"0px auto",textAlign:"center"}},s.createElement("div",null,"Not found page"),s.createElement("button",{style:{padding:"8px 16px",outline:"none",background:"#ddd",margin:20,borderRadius:10},onClick:()=>{i.clearTo("/")}},"Go Home"))}function E(t){t.preventDefault(),t.stopPropagation()}var P={},C=M({stack:o.newStack("/"),isBack:!1,last:!1});function L(){return X(C)}function j({last:t,path:e,stack:r,Component:n,notKeep:a,preload:c,preloadDelay:k}){return A(()=>{if(a&&!t)return null;let f=r.index*100;return c&&!P[e]&&(P[e]=!0,setTimeout(()=>{c.forEach(i.preload)},k||500)),s.createElement(C.Provider,{value:{stack:r,isBack:t&&r.time+100<Date.now(),last:t}},s.createElement(J,{key:e,fallback:s.createElement("div",null)},s.createElement("div",{"data-path":e,style:{zIndex:f,position:"absolute",width:"100%",height:"100%",left:0,top:0},onTouchStart:t?void 0:E,onMouseDown:t?void 0:E},s.createElement(n,null))))},[t,r.url])}function D({NotFoundComponent:t=z}){o.stack.length||(o.stack=[i.newStack(i.nowFullUrl())]),W(m,r=>[r.n]);let e=o.stack.length-1;return s.createElement(s.Fragment,null,o.stack.map((r,n)=>{let a=l[r.path];return a?s.createElement(j,p({last:e===n,key:r.url+n,stack:r},a)):s.createElement(t,{key:r.url+n})}))}var B=(t,e={})=>{let r={};return Object.keys(t).forEach(n=>{r[n]=n;let f=t[n],{render:a}=f,c=v(f,["render"]),k=p({path:n,render:a,Component:G(a)},c);l[n]=k}),{paths:r,Router:()=>s.createElement(D,p({},e))}};var d;function g(){let t=navigator.userAgent.toLocaleLowerCase();return d=new RegExp("(iphone|ipod|ipad)").test(t)&&new RegExp("(micromessenger)").test(t),d}o.useHash=!0;var I={},l={},K=t=>{if(typeof window=="undefined"||window.isTest||I[t])return;let e=l[t];if(!e){console.error(`[create-react-ssx] ${t} isn't Router`);return}return I[t]=!0,e.render()};function S(t,e){return e?t+"?"+new URLSearchParams(e).toString():t}var i={search:()=>{let t=location.href.split("#")[0].split("?");return t.length<2?new URLSearchParams:new URLSearchParams(t[1])},hashSearch:()=>{let t=location.href.split("#")[1].split("?");return t.length<2?new URLSearchParams:new URLSearchParams(t[1])},nowUrl:()=>{if(!location.hash)return"/";let t=location.hash.split("#");return t.length<2?"/":t[1].split("?")[0]},nowFullUrl:()=>{if(!location.hash)return"/";let t=location.hash.split("#");return t.length<2?"/":t[1]},push:(t,e)=>{g()?i.replace(t,e):o.push(S(t,e))},replace:(t,e,r)=>{o.replace(S(t,e),r)},goBack:t=>{g()?i.replace(o.stack[o.stack.length-1].url,t):o.goBack(t)},clearTo:(t,e)=>{o.clearTo(S(t,e))},preload:K,newStack:o.newStack,isIOSWechat:g,create:B,getStack:()=>o.stack,getLastStack:()=>o.stack[o.stack.length-1],isBack:()=>{let t=i.getLastStack();return t.url===i.nowFullUrl()?t.time+100<Date.now():!1},useHistoryChange:L,setOnLastBack:t=>{o.onLastBack=t}};export{l as routeMap,i as vouter};
